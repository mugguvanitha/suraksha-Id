{% extends "base.html" %}

{% block title %}Register - SurakshaID{% endblock %}

{% block content %}
<div class="container py-5">
    <div class="row justify-content-center">
        <div class="col-lg-8">
            <div class="card">
                <div class="card-header bg-primary text-white">
                    <h4 class="mb-0"><i class="fas fa-user-plus"></i> User Registration</h4>
                </div>
                <div class="card-body">
                    {% if error %}
                    <div class="alert alert-danger" role="alert">
                        <i class="fas fa-exclamation-triangle"></i> {{ error }}
                    </div>
                    {% endif %}
                    
                    {% if success %}
                    <div class="alert alert-success" role="alert">
                        <i class="fas fa-check-circle"></i> {{ success }}
                    </div>
                    {% endif %}
                    
                    <form method="POST" action="{{ url_for('register') }}" id="registrationForm">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="name" class="form-label">Full Name *</label>
                                <input type="text" class="form-control" id="name" name="name" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="email" class="form-label">Email Address *</label>
                                <input type="email" class="form-control" id="email" name="email" required>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="phone" class="form-label">Phone Number *</label>
                                <input type="tel" class="form-control" id="phone" name="phone" pattern="[0-9]{10}" required>
                                <div class="form-text">Enter 10-digit phone number</div>
                            </div>
                            <div class="col-md-6 mb-3 position-relative">
    <label for="password" class="form-label">Password *</label>
    <input type="password" 
           class="form-control" 
           id="password" 
           name="password" 
           required>

    <i class="fas fa-eye position-absolute"
       id="togglePassword"
       style="top: 38px; right: 15px; cursor: pointer;"></i>
</div>
                        
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="govt_id_type" class="form-label">Government ID Type *</label>
                                <select class="form-select" id="govt_id_type" name="govt_id_type" required>
                                    <option value="">Select ID Type</option>
                                    <option value="Aadhaar">Aadhaar</option>
                                    <option value="PAN">PAN</option>
                                    <option value="Passport">Passport</option>
                                    <option value="Voter ID">Voter ID</option>
                                </select>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="govt_id_number" class="form-label">Government ID Number *</label>
                                <input type="text" class="form-control" id="govt_id_number" name="govt_id_number" required>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="age" class="form-label">Age *</label>
                                <input type="number" class="form-control" id="age" name="age" min="1" max="150" required>
                            </div>
                        </div>
                       <hr>
<h5>Employment Details</h5>

<div class="row">
    <div class="col-md-6 mb-3">
        <label class="form-label">Are you a Job Holder?</label>
        <select class="form-select" name="is_job_holder" required>
            <option value="">Select</option>
            <option value="YES">Yes</option>
            <option value="NO">No</option>
        </select>
    </div>
</div>

<div class="row">
    <div class="col-md-4 mb-3">
        <label class="form-label">Company Name</label>
        <input type="text" class="form-control" name="company_name">
    </div>
    <div class="col-md-4 mb-3">
        <label class="form-label">Employee ID</label>
        <input type="text" class="form-control" name="emp_id">
    </div>
    <div class="col-md-4 mb-3">
        <label class="form-label">Job Role</label>
        <input type="text" class="form-control" name="job_role">
    </div>
</div>
                        <hr>
                        <h5><i class="fas fa-map-marker-alt"></i> Address Information</h5>
                        
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="house_no" class="form-label">House Number</label>
                                <input type="text" class="form-control" id="house_no" name="house_no">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="locality" class="form-label">Locality</label>
                                <input type="text" class="form-control" id="locality" name="locality">
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="village" class="form-label">Village/City</label>
                                <input type="text" class="form-control" id="village" name="village">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="district" class="form-label">District</label>
                                <input type="text" class="form-control" id="district" name="district">
                            </div>
                        </div>
                        
                        <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                            <a href="{{ url_for('index') }}" class="btn btn-secondary me-md-2">Cancel</a>
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-user-plus"></i> Register
                            </button>
                        </div>
                    </form>
                </div>
            </div>
            
            <div class="card mt-4">
                <div class="card-header">
                    <h5 class="mb-0"><i class="fas fa-info-circle"></i> Important Information</h5>
                </div>
                <div class="card-body">
                    <ul class="list-unstyled">
                        <li><i class="fas fa-check text-success"></i> Your Verification ID will be automatically generated (VID-Phone)</li>
                        <li><i class="fas fa-check text-success"></i> All fields marked with * are mandatory</li>
                        <li><i class="fas fa-check text-success"></i> Email, Phone, and Government ID must be unique</li>
                        <li><i class="fas fa-check text-success"></i> Default verification status will be PENDING</li>
                        <li><i class="fas fa-check text-success"></i> Your data will be handled with privacy and security</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.getElementById('registrationForm').addEventListener('submit', function(e) {
    const phone = document.getElementById('phone').value;
    const email = document.getElementById('email').value;
    const govtIdNumber = document.getElementById('govt_id_number').value;
    
    // Basic validation
    if (phone.length !== 10) {
        e.preventDefault();
        alert('Please enter a valid 10-digit phone number');
        return;
    }
    
    if (!email.includes('@')) {
        e.preventDefault();
        alert('Please enter a valid email address');
        return;
    }
    
    if (govtIdNumber.length < 5) {
        e.preventDefault();
        alert('Please enter a valid government ID number');
        return;
    }
});
document.addEventListener("DOMContentLoaded", function () {

    const toggle = document.getElementById("togglePassword");
    const password = document.getElementById("password");

    toggle.addEventListener("click", function () {

        if (password.type === "password") {
            password.type = "text";
            toggle.classList.remove("fa-eye");
            toggle.classList.add("fa-eye-slash");
        } else {
            password.type = "password";
            toggle.classList.remove("fa-eye-slash");
            toggle.classList.add("fa-eye");
        }

    });

});
// Government ID validation based on type
document.getElementById('govt_id_type').addEventListener('change', function() {
    const idType = this.value;
    const idNumber = document.getElementById('govt_id_number');
    
    idNumber.value = '';
    
    switch(idType) {
        case 'Aadhaar':
            idNumber.maxLength = 12;
            idNumber.pattern = '[0-9]{12}';
            idNumber.placeholder = 'Enter 12-digit Aadhaar number';
            break;
        case 'PAN':
            idNumber.maxLength = 10;
            idNumber.pattern = '[A-Z]{5}[0-9]{4}[A-Z]{1}';
            idNumber.placeholder = 'Enter 10-digit PAN number';
            break;
        case 'Passport':
            idNumber.maxLength = 8;
            idNumber.placeholder = 'Enter Passport number';
            break;
        case 'Voter ID':
            idNumber.maxLength = 10;
            idNumber.placeholder = 'Enter Voter ID number';
            break;
        default:
            idNumber.maxLength = 50;
            idNumber.placeholder = 'Enter government ID number';
    }
});
document.getElementById("is_job_holder").addEventListener("change", function() {
    if (this.value === "Yes") {
        document.getElementById("jobFields").style.display = "block";
    } else {
        document.getElementById("jobFields").style.display = "none";
    }
});
</script>
{% endblock %}
